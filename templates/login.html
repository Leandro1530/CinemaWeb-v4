{% extends "base.html" %}
{% block title %}Iniciar sesiÃ³n | Cinema3D{% endblock %}

{% block head_extras %}
<style>
  /* ===== Login moderno ===== */
  .login-wrap{
    min-height: calc(100dvh - 96px - 80px);
    display:flex; align-items:center; justify-content:center;
    padding: clamp(16px, 3vw, 28px);
  }
  .login-card{
    width:min(440px, 100%);
    background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.08);
    border-radius: 20px;
    box-shadow: var(--shadow-sm);
    backdrop-filter: blur(14px);
    padding: clamp(18px, 3vw, 28px);
    animation: lgFade .35s ease both;
  }
  @keyframes lgFade{from{opacity:0; transform:translateY(8px)} to{opacity:1; transform:none}}

  .login-logo{
    width:84px; height:84px; border-radius:18px; margin:0 auto 14px;
    display:grid; place-items:center;
    background: linear-gradient(135deg,#4f6df5,#7c3aed);
    box-shadow: 0 14px 34px rgba(79,109,245,.35);
  }
  .login-title{ margin:0; text-align:center; font-weight:800; font-size: clamp(1.4rem,2.2vw,1.9rem); }
  .login-sub{ text-align:center; color:var(--muted); margin:.35rem 0 0; }

  .form{ display:grid; gap:14px; margin-top: clamp(16px, 2.4vw, 22px); }

  .field{ display:grid; gap:.45rem; }
  .field label{ font-weight:600; color:#cfd6e5; }
  .control{
    position:relative;
    display:flex; align-items:center;
    background:#0f1428; border:1px solid rgba(255,255,255,.10);
    border-radius:12px; padding: 0 .8rem;
    transition: border-color .2s ease, background .2s ease, box-shadow .2s ease;
  }
  .control:focus-within{
    border-color:#4f6df5; background:#121936;
    box-shadow:0 0 0 3px rgba(79,109,245,.18);
  }
  .control .icon{ margin-right:.55rem; opacity:.9 }
  .control input{
    flex:1; height:44px; border:0; outline:0; background:transparent;
    color:var(--text); font-size:.98rem;
  }
  .toggle-pass{
    border:0; background:transparent; color:#9fb1ff; font-weight:700;
    cursor:pointer; padding:.25rem .2rem; margin-left:.3rem;
  }
  .toggle-pass:hover{ filter:brightness(1.1) }

  .row-remember{ display:flex; align-items:center; gap:.5rem; margin-top:.2rem; }
  .row-remember input{ accent-color:#4f6df5; cursor:pointer; }

  .error-box{
    background: rgba(239,68,68,.10);
    border:1px solid rgba(239,68,68,.28);
    color:#fca5a5;
    border-radius:12px; padding:.8rem 1rem; margin-top:1rem;
  }
  .error-box ul{ margin:0; padding-left:1.2rem; }

  /* ===== Botones de acciÃ³n ===== */
  .actions{
    display:flex;
    gap:.75rem;
    margin-top:.3rem;
  }

  .actions .btn-primary,
  .actions .btn-ghost{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    height:48px;
    padding:0 1rem;
    border-radius:12px;
    font-weight:700;
    text-decoration:none;
    line-height:1;
    box-sizing:border-box;
    flex:1;
  }

  /* Estilo botÃ³n primario */
  .actions .btn-primary{
    background: linear-gradient(135deg,#4f6df5,#7c3aed);
    color:#fff;
    border:0;
    box-shadow:0 10px 24px rgba(79,109,245,.25);
    transition:transform .15s ease, box-shadow .15s ease, filter .15s ease;
  }
  .actions .btn-primary:hover{ transform:translateY(-1px); filter:brightness(1.03); }

  /* Estilo botÃ³n ghost */
  .actions .btn-ghost{
    background: rgba(255,255,255,.08);
    color: #e8edf7;
    border:1px solid rgba(255,255,255,.16);
    transition: background .15s ease, border-color .15s ease, filter .15s ease;
  }
  .actions .btn-ghost:hover{
    background: rgba(255,255,255,.12);
    border-color: rgba(255,255,255,.22);
  }

  /* En mÃ³vil, ambos ocupan todo el ancho */
  @media (max-width:520px){
    .actions .btn-primary,
    .actions .btn-ghost{ flex:1; width:100%; }
  }

  .login-footer{
    margin-top:1.1rem; padding-top:1rem;
    border-top:1px solid rgba(255,255,255,.08);
    text-align:center; color:var(--muted);
  }
  .login-footer a{ font-weight:700; }

  @media (max-width:480px){
    .login-card{ padding:18px; }
  }
</style>
{% endblock %}

{% block content %}
<div class="login-wrap">
  <div class="login-card">
    <!-- Logo -->
    <div class="login-logo" aria-hidden="true">
      <span style="font-size:2rem">ðŸŽ¬</span>
    </div>

    <h1 class="login-title">Iniciar sesiÃ³n</h1>
    <p class="login-sub">AccedÃ© a tu cuenta de Cinema3D</p>

    {% if errores %}
      <div class="error-box" role="alert">
        <ul>{% for e in errores %}<li>{{ e }}</li>{% endfor %}</ul>
      </div>
    {% endif %}

    <form class="form" method="post" action="{{ url_for('auth.login') }}" autocomplete="on" novalidate>
      <input type="hidden" name="next" value="{{ next_url or url_for('venta.cartelera') }}"/>

      <!-- Email o DNI -->
      <div class="field">
        <label for="login_id">Email o DNI</label>
        <div class="control">
          <span class="icon">ðŸ“§</span>
          <input id="login_id" name="login_id"
                 value="{{ login_id or '' }}"
                 placeholder="tu@email.com o 12345678"
                 required autocomplete="username">
        </div>
      </div>

      <!-- ContraseÃ±a -->
      <div class="field">
        <label for="password">ContraseÃ±a</label>
        <div class="control">
          <span class="icon">ðŸ”’</span>
          <input id="password" type="password" name="password"
                 placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required autocomplete="current-password">
          <button class="toggle-pass" type="button" id="showHideBtn" aria-controls="password" aria-pressed="false">Ver</button>
        </div>
      </div>

      <div class="row-remember">
        <input type="checkbox" id="recordarme" name="recordarme" value="1">
        <label for="recordarme" style="cursor:pointer;">Recordarme en este dispositivo</label>
      </div>

      <!-- Botones -->
      <div class="actions">
        <a class="btn-ghost" href="{{ url_for('venta.cartelera') }}">Cancelar</a>
        <button class="btn-primary" type="submit">Entrar â†’</button>
      </div>

      <div class="login-footer">
        Â¿No tenÃ©s cuenta?
        <a href="{{ url_for('auth.registro') }}">Registrate</a>
      </div>
    </form>
  </div>
</div>

<script>
  // Toggle de mostrar/ocultar contraseÃ±a
  (function(){
    const input = document.getElementById('password');
    const btn   = document.getElementById('showHideBtn');
    if (!input || !btn) return;

    btn.addEventListener('click', () => {
      const show = input.type === 'password';
      input.type = show ? 'text' : 'password';
      btn.textContent = show ? 'Ocultar' : 'Ver';
      btn.setAttribute('aria-pressed', show ? 'true' : 'false');
      input.focus();
    });
  })();
</script>
{% endblock %}
